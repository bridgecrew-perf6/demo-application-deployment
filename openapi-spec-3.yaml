openapi: "3.0.0"
info: 
  description: "API encargada de resolver la integraciÃ³n con SAP para ventas."
  title: ventas
  version: "1.0.0"
components: 
  schemas: 
    detalle: 
      properties: 
        cantidad: 
          description: "Cantidad vendida del producto"
          type: number
        producto: 
          $ref: "#/components/schemas/producto"
        unidad-de-medida: 
          description: "Unidad con la que se mide el producto"
          type: string
    eds: 
      properties: 
        codigo: 
          description: "Identificador de una estaciÃ³n de servicio"
          type: string
    entrega: 
      properties: 
        costo-flete: 
          description: "Costo del flete asociado a la operaciÃ³n si corresponde"
          type: number
        descripcion: 
          description: "DescripciÃ³n del tipo de entrega"
          type: string
        tipo: 
          description: "Tipo de entrega"
          type: string
    estado-transaccion: 
      properties: 
        comentarios: 
          description: "InformaciÃ³n del error funcional"
          type: string
        comision-flete: 
          description: "ComisiÃ³n del flete"
          type: number
        condicion-precio: 
          description: "Tipo de acuerdo de precio"
          type: string
        descuento: 
          description: "Monto en pesos de descuento"
          type: number
        id: 
          description: "Identificador de la transacciÃ³n"
          type: number
        monto-comision: 
          description: "ComisiÃ³n de la estaciÃ³n"
          type: number
        pedido: 
          description: "Numero de pedido con que se registra la transacciÃ³n en SAP"
          type: string
        posicion: 
          description: "PosiciÃ³n dentro del pedido"
          type: integer
    guia-despacho: 
      properties: 
        folio: 
          description: "NÃºmero de la guÃ­a de despacho"
          type: string
    problem: 
      properties: 
        detail: 
          description: |
              A human readable explanation specific to this occurrence of the
              problem.
          example: "Your current balance is 30, but that costs 50."
          type: string
        instance: 
          description: |
              An absolute URI that identifies the specific occurrence of the problem.
              It may or may not yield further information if dereferenced.
          example: /account/12345/msgs/abc
          format: uri
          type: string
        status: 
          description: |
              The HTTP status code generated by the origin server for this occurrence
              of the problem.
          example: 403
          exclusiveMaximum: true
          format: int32
          maximum: 600
          minimum: 100
          type: integer
        title: 
          description: |
              A short, summary of the problem type. Readable for engineers
              (usually not suited for non technical stakeholders and not localized);
              example: Service Unavailable
          example: "You do not have enough credit"
          type: string
        type: 
          default: "about:blank"
          description: |
              An absolute URI that identifies the problem type.  When dereferenced,
              it SHOULD provide human-readable documentation for the problem type
              (e.g., using HTML).
          example: "https://example.com/probs/out-of-credit"
          format: uri
          type: string
      type: object
    producto: 
      properties: 
        codigo: 
          description: "CÃ³digo del producto"
          type: string
        precio-unitario: 
          description: "Valor unitario del producto"
          type: number
        tipo: 
          description: "Tipo del producto"
          type: string
    tarjeta: 
      properties: 
        numero: 
          description: "NÃºmero de tarjeta"
          type: string
        tipo: 
          description: "Tipo de tarjeta"
          type: string
    transaccion: 
      properties: 
        condicion-precio: 
          description: "Tipo de acuerdo de precio"
          type: string
        entrega: 
          $ref: "#/components/schemas/entrega"
        estacion: 
          $ref: "#/components/schemas/eds"
        estado-vigencia: 
          description: "Estado de vigencia de la transacciÃ³n que permite anularla"
          type: string
        fecha: 
          description: "Fecha de la operaciÃ³n"
          type: string
        firma-electronica: 
          description: "CÃ³digo de firma electrÃ³nica del documento legal"
          type: string
        guia-despacho: 
          $ref: "#/components/schemas/guia-despacho"
        hora: 
          description: "Hora de la operaciÃ³n"
          type: string
        id: 
          description: "Identificador de la transacciÃ³n"
          type: number
        numero-rollo-voucher: 
          description: "NÃºmero de rollo asociado al voucher emitido"
          type: string
        orden-compra-cliente: 
          description: "Orden de compra de los clientes fiscales"
          type: string
        solicitante: 
          description: "CÃ³digo de la persona que solicita la operaciÃ³n"
          type: string
        tarjeta: 
          $ref: "#/components/schemas/tarjeta"
        validacion-anillo: 
          description: "Estado de la validaciÃ³n del anillo"
          type: string
        vehiculo: 
          $ref: "#/components/schemas/vehiculo"
        venta: 
          $ref: "#/components/schemas/venta"
    vehiculo: 
      properties: 
        correlativo: 
          description: "Correlativo del vehÃ­culo del cliente"
          type: string
        odometro: 
          description: "Kilometraje actual del vehÃ­culo"
          type: string
        patente: 
          description: "Patente del vehÃ­culo"
          type: string
        tipo: 
          description: "Tipo de vehÃ­culo"
          type: string
    venta: 
      properties: 
        detalle: 
          items: 
            $ref: "#/components/schemas/detalle"
          type: array
        precio-total: 
          description: "Valor total de la venta"
          type: number
  securitySchemes: 
    api_key: 
      in: header
      name: api_key
      type: apiKey
    basicAuth: 
      scheme: basic
      type: http
paths: 
  /tarjetas-combustible: 
    post: 
      description: "OperaciÃ³n que permite la integraciÃ³n con SAP para registrar la venta con tarjetas TAE (Tarjeta de Abastecimiento en Empresa) y TCT (Tarjeta Copec de Transporte)."
      operationId: tarjetaCombustible
      requestBody: 
        content: 
          application/json: 
            example: 
              condicion-precio: T02
              eds: 
                codigo: 0000010197
              entrega: 
                costo-flete: 0
                descripcion: "00"
                tipo: R
              estado-vigencia: ""
              fecha: "20220304"
              firma-electronica: "GE|<CAF version=\"1.0\"><DA><RE>99520000-7</RE><RS>COPEC S.A.</RS>"
              guia-despacho: 
                folio: 000010860361
              hora: "71600"
              id: 12345
              numero-rollo-voucher: "000000000001"
              orden-compra-cliente: "0"
              solicitante: 0000663287
              tarjeta: 
                numero: "00120"
                tipo: TAE
              validacion-anillo: ""
              vehiculo: 
                correlativo: "0020"
                odometro: "0000000"
                patente: "CC 260"
                tipo: "12"
              venta: 
                detalle: 
                  - 
                    cantidad: 70
                    producto: 
                      codigo: "000000000000000013"
                      precio-unitario: 878
                      tipo: COMB
                    unidad-de-medida: L
                precio-total: 61460
            schema: 
              $ref: "#/components/schemas/transaccion"
        description: "Datos de entrada"
        required: true
      responses: 
        ? "202"
        : 
          description: "La solicitud se a recibido correctamente."
        default: 
          content: 
            application/problem+json: 
              schema: 
                $ref: "#/components/schemas/problem"
          description: "La solicitud no se a podido procesar por algÃºn problema."
      summary: tarjetas-combustible
      tags: 
        - Operaciones
  /tarjetas-combustible-callback: 
    post: 
      description: "OperaciÃ³n que permite a SAP responder el resultado del registro de la venta  con tarjeta TAE o TCT."
      requestBody: 
        content: 
          application/json: 
            example: 
              comentarios: ""
              comision-flete: 0
              condicion-precio: D08
              descuento: 1750
              id: 12345
              monto-comision: 490
              pedido: 0368304912
              posicion: 10
            schema: 
              $ref: "#/components/schemas/estado-transaccion"
        description: "Datos de entrada"
        required: true
      responses: 
        ? "202"
        : 
          description: "La solicitud se a recibido correctamente."
        default: 
          content: 
            application/problem+json: 
              schema: 
                $ref: "#/components/schemas/problem"
          description: "La solicitud no se a podido procesar por algÃºn problema."
      summary: tarjetas-combustible-callback
      tags: 
        - Operaciones
security: 
  - 
    api_key: []
  - 
    basicAuth: []
servers: 
  - 
    url: ventas.tarjeta-copec-poc.svc.cluster.local
tags: 
  - 
    description: TÃ©cnica
    name: Tipo
  - 
    description: DiseÃ±o
    name: Estado
